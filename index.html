<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KÃ¤sa SozanÃ¤mu</title>
    <style>
        :root {
            --primary: #00b195;
            --secondary: #fc2537;
            --background: #07080b;
        }

        /* åŠ è½½çŠ¶æ€æ ·å¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
    		transform: none !important; /* ç¦ç”¨ç¼©æ”¾å½±å“ */
            background: var(--background);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            gap: 2rem;
        }

        .status-symbol {
            width: 80px;
            height: 80px;
            position: relative;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading-symbol {
            border: 4px solid rgba(255,255,255,0.2);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* é”™è¯¯ç¬¦å· */
        .error-symbol::before,
        .error-symbol::after {
            content: '';
            position: absolute;
            background: var(--secondary);
            left: 50%;
            top: 50%;
            width: 40px;
            height: 4px;
            border-radius: 2px;
        }
        .error-symbol::before {
            transform: translate(-50%, -50%) rotate(45deg);
        }
        .error-symbol::after {
            transform: translate(-50%, -50%) rotate(-45deg);
        }

        /* åˆ·æ–°æŒ‰é’® */
        .retry-symbol {
            border: 4px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            width: 60px;  /* è°ƒæ•´å°ºå¯¸ */
            height: 60px;
            background: transparent;
        }


        .retry-symbol::before {
            content: none;
        }

        .retry-symbol:hover {
            transform: scale(1.1);  /* æ‚¬åœæ—¶æ”¾å¤§ */
            border-color: var(--primary);  /* æ‚¬åœæ—¶å˜ä¸ºä¸»è‰² */
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        

        /* ä¸»è¦å†…å®¹æ ·å¼ */
        body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            background: var(--background);
            font-family: 'Kiineza', monospace;
            color: white;
            line-height: 0.8;
            transform-origin: top left;
        }

        .left-panel {
            flex: 6;
            padding: 3rem;
            border-right: 1px solid #2b323b;
            position: relative;
        }

        .right-panel {
            position: relative;
            flex: 4;
            padding: 3rem;
            position: relative;
            display: flex;
            min-width: 200px;
            flex-direction: column;
        }

        .display-box {
            width: 100%;
            padding: 2rem;
            margin-bottom: 3rem;
            font-size: 5.4rem;
            top: -0.6rem;
            background: #131318;
            border: none;
            color: var(--primary);
            font-family: 'Kiineza';
            line-height: 0.8;
            outline: none;
        }

        .keyboard {
            display: flex;
            gap: 0.1rem;
        }

        .key-column {
            display: flex;
            flex-direction: column;
            gap: 0.1rem;
        }

        .key {
            width: 5.4rem;
            height: 5.4rem;
            padding: 0;
            background: #131318;
            border-radius: 8px;
            cursor: pointer;
            font-size: 4.2rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 0.8;
            position: relative;
            overflow: visible;
        }

        .key::after {
            content: attr(data-char);
            position: absolute;
            top: -0.7rem;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .vowel-key {
            font-size: 5.6rem !important;
            letter-spacing: -0.1rem;
        }
        
        .vowel-key::after {
            font-size: 5.6rem;
            top: -0.8rem;
        }

        .key:hover {
            background: var(--primary);
            color: var(--background);
        }


        /* åŒ…è£¹å•è¯é‚£ä¸€è¡Œçš„å®¹å™¨ï¼Œä½œä¸ºå®šä½ä¸Šä¸‹æ–‡ */
        .word-line-wrapper {
          position: relative;
          display: inline-block;   /* å®½åº¦ä¸æ–‡å­—ä¸€è‡´ */
          line-height: 1;          /* ç¡®ä¿é«˜åº¦ = å­—ä½“å¤§å° */
          margin-bottom: 0.5rem; 
        }

        /* â€œæœ—è¯»â€æŒ‰é’®ï¼šç»å¯¹å®šä½åˆ°å®¹å™¨åº•éƒ¨ã€å³ä¾§ */
        .read-button {
          position: absolute;
          bottom: 0;               /* ä¸ .word-line åº•è¾¹è´´åˆ */
          right: -4.6rem;          /* å¾€å³åä¸€ç‚¹ï¼Œé˜²æ­¢é®å­—ï¼›æ ¹æ®å­—ä½“å¤§å°å¾®è°ƒ */
          background: none;        /* å»æ‰èƒŒæ™¯ */
          border: none;            /* å»æ‰è¾¹æ¡† */
          padding: 0;
          font-size: 2.8rem;       /* å›¾æ ‡å¤§å°ï¼Œå¯è°ƒ */
          line-height: 1;          /* å’Œæ–‡å­—è¡Œé«˜ä¸€è‡´ */
          cursor: pointer;
        }

        /* æ‚¬åœæ—¶å¯ä»¥è½»å¾®æ”¾å¤§ï¼ˆå¯é€‰ï¼‰ */
        .read-button:hover {
          transform: scale(1.0);
          text-shadow: 
            -2.5px -2.5px 0 var(--primary),
             2.5px -2.5px 0 var(--primary),
            -2.5px  2.5px 0 var(--primary),
             2.5px  2.5px 0 var(--primary);
        }

        .result-box {
            font-size: 6.5rem;
            font-family: 'Kiineza';
            line-height: 0.8;
            min-height: 80px;
        }

        .translation {
            color: var(--secondary);
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            font-size: 3.5rem;
            line-height: 1;
        }

        .version {
            margin-top: auto;            
            color: #12131a;
            font-size: 2rem;
        }

        .help-button {
            position: absolute;
            bottom: 3rem; /* ä¸ç‰ˆæœ¬å·åº•è¾¹å¯¹é½ */
            right: 3rem;
            z-index: 100; /* ç¡®ä¿æŒ‰é’®åœ¨æ­£ç¡®å±‚çº§ */
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: var(--background);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 2.5rem;
            font-family:  'Segoe UI Semibold','Microsoft YaHei', 'Source Han Sans CN', 'Roboto','Helvetica Neue',sans-serif;
            line-height: 0.5;
            transition: all 0.3s;
        }

        .help-button:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }

        /* æ–°å¢å¸®åŠ©å¼¹çª—æ ·å¼ */
        .help-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(7, 8, 11, 0.95);
            display: none; /* ç¡®ä¿åˆå§‹éšè— */
            align-items: center;
            justify-content: center;
            z-index: 2000;
            cursor: pointer;
        }

        .help-image {
            width: auto;
		    height: auto;
		    max-width: min(90vw, 1200px);
		    max-height: min(80vh, 1000px);
		    margin: auto;
            border: 2px solid var(--primary);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 177, 149, 0.3);
        }


        @media (max-width: 1200px) {
            body {
                transform: scale(0.9);
                width: 111%;
            }
        }

        @media (max-width: 1000px) {
            body {
                transform: scale(0.8);
                width: 125%;
            }
        }

        /* å¢åŠ ç§»åŠ¨ç«¯åª’ä½“æŸ¥è¯¢ */
        @media (orientation: portrait) and (max-width: 768px) {
            body {
                transform: none !important;
                width: 100% !important;
            }
            .help-image {
            width: 95vw; /* ç«–å±æ—¶ä½¿ç”¨è§†å£å®½åº¦å•ä½ */
            height: auto;
            object-fit: contain;
    }


            
        }

        [data-char="â†µ"]::after {
            font-family: 'Segoe UI Semibold','Microsoft YaHei', 'Source Han Sans CN', 'Roboto','Helvetica Neue',sans-serif;
            top: -0.2rem;
        }
    </style>
</head>
<body>
    <div class="loading-overlay">
        <div class="status-symbol loading-symbol"></div>
        <div class="status-symbol error-symbol" style="display: none;"></div>
        <button class="status-symbol retry-symbol" style="display: none;"></button>
    </div>

    <div class="left-panel">
        <input type="text" class="display-box" id="display" readonly>
        <div class="keyboard" id="keyboard"></div>
    </div>
    <div class="right-panel">
        <div class="result-container">
          <div id="result" class="result-box"></div>
        </div>
        <div class="version">lokam 1.10</div>
        <div class="help-button">?</div>
    </div>
    <div class="help-overlay" id="helpOverlay">
        <img src="img/help-image.jpg" class="help-image" alt="HÃ¶uhu">
    </div>

<script>
const encrypted = 'ew0KICAieGEiOiAieHlzSG1wU3luLCBiSSBreW5kaVN5bnogZk8sIHhpZiB4aXQgaEdweW56IFZlbiIsDQogICJ4QSI6ICJiaWxvTmlOIHRVLCBbcWVuaXRpdiBzSGZpa3NdLCBbeE9kaW55bCBuSG1iWSBzSGZpa3NdIiwNCiAgInhBbiI6ICJ4QWZ0eS4uLiBbdEptXSwgbEt0eSBWeW4uLi4sIHhpbiBmckhudCB4b3YuLi5beEdudGlzaXYgc0hmaWtzXSwgdFUgYmlsb04gdFUiLA0KICAieEFtIjogImJpZk8uLi4gW3RKbV0sIHhZbGkveSBWeW4uLi4sIGJpaEpuZC4uLltwWHN0aXNpdiBzSGZpa3NdIiwNCiAgInhhbSI6ICJGaU4sIHhKdHltIiwNCiAgImJBYiI6ICJmQVZ5IiwNCiAgImJBeGliIjogImJpem55cywgbVljeW50LCBreW1ZU3lsLCB0VSB0cktkIiwNCiAgImJBeGliYW0iOiAia3ltb2RpdGksIHByb2RIa3QiLA0KICAiYkF4aXQiOiAidFUgZkp0IiwNCiAgImJheiI6ICJwbEtzLCBsWGtLU3luLCBweXppU3luLCB0ZXJpdHlyaSIsDQogICJiRSI6ICJzeXBySnppTmxpLCB4R2tzaWRlbnR5bGksIHhJdnluLCB4WG5saSwgc3RpbCwgW3hpbnR5cWVrU3luXSIsDQogICJiRWx1ZCI6ICJiWWQiLA0KICAiYkVsdWRhbU96ZXoiOiAieGVnIiwNCiAgImJFbHVkYXNJeGFuIjogImZlVnkiLA0KICAiYkVsdWRhdGV0IjogIndpTiIsDQogICJiRXN1dCI6ICJndWQsIHdlbCwgcHJvcHksIGt5cmVrdCwgbEhrLCB0VSB4SHBncktkIiwNCiAgImJFc3V0YW4iOiAieGluc0p0LCB0VSB4SG5keXN0R25kIiwNCiAgImJ1YmF6IjogInhJc3QiLA0KICAiYnV6IjogInJKdCIsDQogICJkIjogInRVIHdLdCIsDQogICJkQSI6ICJzS20iLA0KICAiZEFraW1PdCI6ICJ4ZW1weUZpIiwNCiAgImRhYmF6IjogImZlbFgsIGJySFZ5LCBmcmVuZCIsDQogICJkYW1hbSI6ICJuVyIsDQogICJkT2J1cyI6ICJ4R25pbXlsIiwNCiAgImRPYnVzYWhVbGV6IjogImhPbiIsDQogICJkT2J1c2FrdXRhbSI6ICJtSXQgW3hlZHlieWxdIiwNCiAgImRPZyI6ICJoVyIsDQogICJkT2wiOiAiaFUiLA0KICAiZE9tIjogIndvdCIsDQogICJkT21hbSI6ICJ3ZW4iLA0KICAiZE9tVW4iOiAid0oiLA0KICAiZE94dWciOiAidFVsLCBqVXRlbnN5bCIsDQogICJkT3oiOiAid1AiLA0KICAiZFUiOiAiW2t5bXBHcnl0aXYgcHJJZmlrc10iLA0KICAiZ1UiOiAiW3NVcFlseXRpdiBwcklmaWtzXSIsDQogICJkdWJheiI6ICJuT0YiLA0KICAiZHVnIjogImhlZCIsDQogICJkdWdhbGFtIjogIm5layIsDQogICJkdWh1a1VzIjogInhIcHkga2xYVnosIHFHa2l0LCBrWHQiLA0KICAiZHVoVWwiOiAidFUgZmxYdCIsDQogICJkdWhVbGFuIjogInRVIHN3aW0iLA0KICAiZHVrRWhVbCI6ICJrbFdkIiwNCiAgImR1a0V2IjogInNrSiIsDQogICJkdWtFdmFoVWwiOiAicktuIiwNCiAgImR1a0V2YW4iOiAidFUgZmxKIiwNCiAgImR1a0V2aWwiOiAiYmxVIiwNCiAgImR1a0V2b2tJaFVsIjogInNuWCIsDQogICJkdWxhayI6ICJ2WXRpa3lsIiwNCiAgImR1bGFrdWxVbSI6ICJ4ZWxpdkt0eSIsDQogICJkdXNPdCI6ICJnb2QiLA0KICAiZHVzT3RhbSI6ICJmUHJpIHRLbCwgbWlGb2x5cWkiLA0KICAiZHV0IjogInRVIHJKeiIsDQogICJkdXRPayI6ICJ0T2wiLA0KICAiZHV2aWsiOiAiU090IFt2WXRpa3lsXSIsDQogICJkdXZPeiI6ICJ0VSBzdEduZCIsDQogICJkdXoiOiAieEhweSwgeEhwIiwNCiAgInhlIjogImJIdCwgeGVrc2VwdCwgeEhWeSBWeW4sIFtkR3RpdiBzSGZpa3NdLCBbbmVneXRpdiBwcklmaWtzXSIsDQogICJ4ZWQiOiAic2ltaWx5IHRVLi4uW3NlbWJseXRpdiBzSGZpa3NdIiwNCiAgInhlbCI6ICJ0VSwgZEhieWwsIFZHbi4uLltreW1wR3J5dGl2IHNIZmlrc10iLA0KICAieGVoIjogImpVemlOLi4uW3hpbnN0cnltZW50eWwgc0hmaWtzXSIsDQogICJ4RSI6ICJ4eW1LemlOLCB4SG5iaWxJdnlieWwsIHhHYnN5bFV0bGksIFt4aW50eXFla1N5bl0iLA0KICAieGVtIjogInRVLi4uW3hHbHl0aXYgc0hmaWtzXSIsDQogICJ4ZW4iOiAiZnJvbS4uLlt4R2JseXRpdiBzSGZpa3NdIiwNCiAgInhldCI6ICJ4R3QuLi5bbG9reXRpdiBzSGZpa3NdIiwNCiAgInhlekEiOiAieGlueSwgW3hpbmVzaXYgc0hmaWtzXSIsDQogICJ4ZXpJIjogInhXdHNKZHksIHN5clduZGlOLCBbeHlsS3RpdiBzSGZpa3NdIiwNCiAgInZ1c1VuIjogInhvZnluLCBqVVpVL3lsLCBuT215bCIsDQogICJnIjogImRqVXRpLCBueXNlc2l0aSwgbUhzdCwgU3VkLCBuSWQiLA0KICAiZ0FrIjogInR3ZWx2IHRVIFZ5IHBXL3kgeG92IGZKdiIsDQogICJnQWhVbCI6ICJzSSwgeFhTeW4iLA0KICAiZ0FoVWxha2F2QWwiOiAidEpkeWwiLA0KICAiZ0FrQXMiOiAidFUgYkkgYk9uIiwNCiAgImdBa09tIjogImRlRiwgeHluSi95bEtTeW4sIHRVIGRKLCB0VSBraWwiLA0KICAiZ0FsIjogIm1lbmkiLA0KICAiZ0FsQXhpdCI6ICJ4QXRpa3lsLCB0ZWtzdCIsDQogICJnQWxva2FtIjogImRpZmlreWx0LCBrb21wbGlrS3RpZCIsDQogICJnQW0iOiAiRmlOa2ZIbEksIGtQZnlsaSIsDQogICJnQW1hbUFuZW0iOiAiZnlyZXZ5LCB4aXRZbnlsIiwNCiAgImdBdmF0QWwiOiAiYnJPZGtBc3QsIGxKdnNySXQiLA0KICAiZ0VrIjogInR3ZWx2IHRVIFZ5IHBXL3kgeG92IEZySSIsDQogICJnSWsiOiAidHdlbHYgdFUgVnkgcFcveSB4b3YgZk8iLA0KICAiZ09rIjogInR3ZWx2IiwNCiAgImdVayI6ICJ0d2VsdiB0VSBWeSBwVy95IHhvdiB0VSIsDQogICJoIjogImhYcCwgdFUgd29udCwgdFUgd2lTIiwNCiAgImhhYmF6IjogIndlc3QiLA0KICAiaGFidWciOiAiU1hsZHkiLA0KICAiaGFidWsiOiAiaG9yaXpvbnR5bCIsDQogICJoYWtBcyI6ICJ4ZXZpZHlucywgc2ltYnlsLCBsWGdYLCBtQWssIHNKbiwgc2ltcHR5bSIsDQogICJoYXoiOiAibGVmdCIsDQogICJoYXpVayI6ICJTS20sIGRpc2dyS3MiLA0KICAiaGVsQWIiOiAidFUgY1V6IiwNCiAgImhlbE94aW4iOiAic2VrcyIsDQogICJoZXoiOiAiU0twLCBzdEpsLCB4aW1wcmVTeW4sIHBHdHluIiwNCiAgImhJZGVuIjogInNJa3JIdCwgdFUgaEpkLCB0VSBrSHZ5IHhIcCIsDQogICJoaWtBbCI6ICJsSnQsIGJySnQsIHRVIFNKbiIsDQogICJoaWtBbGFtIjogImxHbXAsIGxKdCwgbEFudHluIiwNCiAgImhpbCI6ICJrSGxZIiwNCiAgImhpbGFkT3h1ZyI6ICJwS250aU4gdFVsLCBwS250aU4gYnJIUywgcGlnbXludCIsDQogICJoaWxha2FrSW4iOiAiZmxXL1kiLA0KICAiaGltRXoiOiAieGltaXEsIHBpa2N5LCBmWHRYLCB0VSBwS250IiwNCiAgImhpbkF6dW0iOiAieGlsZWt0cmlzaXRpLCB4ZWxpa3Ryb25paywgRkhuZHkiLA0KICAiaGluQXp1bWFoaWtBbGFtIjogInhpbGVrdHJpayBsSnQiLA0KICAiaGluQXp1bWFsQXhpdCI6ICJwcmludCIsDQogICJoaXZFbnV0IjogInhHa3Rpdml0aSwgZmVzdGl2eWwsIHNlcmlteW5pLCB4aXZlbnQsIHBsR24iLA0KICAiaG9nT2wiOiAiZFl0aSIsDQogICJob2dPbGFtIjogInRyR1MiLA0KICAiaG9sIjogImhBdCIsDQogICJoT3h1aCI6ICJ3SywgbWVGeWQsIG1JbnosIG1IbHRpcGxpa0tTeW4gW21HRl0iLA0KICAiaHVrVXMiOiAia2xYVnoiLA0KICAiaFViRXN1dCI6ICJ0VSB3b1MiLA0KICAiaFVnQWwiOiAic29mdCIsDQogICJzSXhhbmFrVXhhZ2F0IjogIndZbSIsDQogICJoVWtJbiI6ICJzTGwsIGRZdCwgcFdkeSwgcEtzdCIsDQogICJoVWt1dCI6ICJ0VSBkcmlOayIsDQogICJoVWwiOiAid090eSIsDQogICJoVWxleiI6ICJ4QWssIGtZdiwga3Jlc3ludCIsDQogICJoVWxlemF0IjogInRVIHRZbiIsDQogICJoVWxzZXoiOiAidFUgZGlnIiwNCiAgImhVc2lsIjogImhBZCIsDQogICJoVXZha0VsIjogInRVIGRpc29sdiIsDQogICJrRXZha0VsIjogInRVIGRpc3BZcyIsDQogICJ4aSI6ICJ4TywgeEpWeSIsDQogICJ4SSI6ICJoWGxkaU4sIGt5bnRLbmlOLCBbeGluc3RyeW1lbnR5bOKAkWtvbWl0S3RpdiBzSGZpa3NdLCBba0FkaW55bCBuSG1iWSBzSGZpa3NdIiwNCiAgInhJbiI6ICJ0VSBoR3YsIHRVIGt5bnRLbiIsDQogICJ4aWtPbCI6ICJiSSwgYkkgeElrd3lsIHRVIiwNCiAgImsiOiAicG9zeWJpbGl0aSwgcHJvYnliaWxpdGksIG1LYkksIG1LLCBrR24iLA0KICAia0EiOiAiW3BBdGlreWwgZk8gcmlnclVwaU4gbUhsdGlweWwgbW9kaWZKL3l6XSIsDQogICJrQWsiOiAiVksiLA0KICAia0FzIjogInhlZ3ppc3R5bnMsIGxKZiwgbGl2aU4sIHRVIHhlZ3ppc3QsIHRVIFNYIHhIcCwgVnkga0hudHJpIHhHbmQgVnkgcGxHbml0IG5LbSBba0FzSF0iLA0KICAieG9rQXMiOiAiVnkgbUhWWSBwbEduaXQiLA0KICAia0FzYW1ha2VuIjogInNwcmlOIiwNCiAgImtBc2V6IjogInN0QV9TS3B0LCBTQXAsIEZPbmksIHByaWtsaSIsDQogICJrQXNlemF0IjogInRVIHN0R2IsIHRVIHBBcyBGclUiLA0KICAia0F2aWxhayI6ICJ4eSBncktTeXMgakhOIGtpTiB4b3YgVnkga0hudHJpIGJHayB4aW4gVnkgaGlzdHlyaSwgd1lTaXB0IHhHeiB4eSBnb2QgYkogbEt0eSBxZW55cktTeW56IiwNCiAgImthYkFuIjogImt5bnRLbnksIGJva3MsIGJHZywgYkhraXQsIGJvdHlsLCB0VSBreW50S24sIHRVIHJHcCIsDQogICJrYWsiOiAiaEksIFNJLCB4aXQiLA0KICAia2FrSW4iOiAicGxHbnQiLA0KICAia2FrSW5hbk9rYW0iOiAidHJJIGJyR2MiLA0KICAia2FrSW5hdG90IjogInJVdCIsDQogICJrYWtJbmF6SSI6ICJ0ckkgYkFrIiwNCiAgImtha0luaWwiOiAiZ3JJbiIsDQogICJrYWtJbm9rdXRhbSI6ICJ2ZXFpdHlieWwiLA0KICAia2FsQWQiOiAiYm9kaSIsDQogICJrYWxBZGFoVWwiOiAiYmxIZCIsDQogICJrYWxBZGFrSW4iOiAiYlhuIiwNCiAgImthbEFkYXNJeGFuIjogImhQIFtoZWRdIiwNCiAgImthbEFkYXpBIjogIm1JdCIsDQogICJrYWxBZGF6YW0iOiAiYkdrIiwNCiAgImthbEFkYXphbiI6ICJiZWxpIiwNCiAgImthbEFkYXpJIjogInNraW4iLA0KICAia2FsSXZ1cyI6ICJsSWYiLA0KICAia2F0QW4iOiAibkpmLCB0VSBjb3AsIHRVIHNsR1MiLA0KICAia2F2QWwiOiAidFUgY0tucSwgdFUgYmlrSG0sIGJJIHhJa3d5bCB0VSBbbUdGXSIsDQogICJrYXpJdCI6ICJmclV0IiwNCiAgImthekl0YW1ha2VuIjogInhPdEhtIiwNCiAgImtFIjogIm5YIiwNCiAgImtFaFVsIjogImZvZyIsDQogICJrRWtJbiI6ICJzbVhrIiwNCiAgImtFa3VsVW0iOiAicGxLbiIsDQogICJrRWt1dCI6ICJ0VSBicklWIiwNCiAgImtFdiI6ICJ3aW5kLCB4UCwgdkdralVtIiwNCiAgImtFdmV6IjogInRySi9HTmd5bCIsDQogICJrRXZpbCI6ICJ0ckduc3BHcnludCIsDQogICJrZWhhYnVrIjogInRpbHRpZCBbbm90IGhvcml6b250eWxdIiwNCiAgImtlaGlrQWxhaGV6IjogIlNHZFgiLA0KICAia2VoaWtBbCI6ICJkQWsiLA0KICAia2VoaWtBbGlsIjogImJsR2siLA0KICAia2VoVWt1dCI6ICJ0VSB2b21pdCIsDQogICJrZWhVbGV6IjogInN0ckt0IiwNCiAgImtla0FzZXoiOiAic21VViIsDQogICJrZWtFa3V0IjogInRVIGJsWCIsDQogICJrZWtPbWV6IjogImJIbHEsIHByeXRyVVp5biIsDQogICJrZWt1dCI6ICJ0VSBzcGl0IiwNCiAgImtlbGV2aW0iOiAiaEFmIiwNCiAgImtlbSI6ICJ6UXJYLCBuSEZpTiIsDQogICJrZW4iOiAiZk8iLA0KICAia2VuZXZpbSI6ICJrd090eSIsDQogICJrZXMiOiAiZkp2IiwNCiAgImtlc29oVWwiOiAiZHJKIiwNCiAgImtldiI6ICJGckkiLA0KICAia2V6IjogIm5Yd1AiLA0KICAia0kiOiAiamVzLCB4WGtLIiwNCiAgImtJZ0FsIjogImhldmkiLA0KICAia0loVWwiOiAieEpzIiwNCiAgImtJa3VsVW0iOiAia0EsIGJIcywgdHJLbiIsDQogICJrSW4iOiAic3RYbiwgc29saWQsIHRVIHN5bGlkaWZKIiwNCiAgImtJbmV6IjogImt3b2RyaWxHdHlyeWwsIHNrd1AsIHJvbWJ5cyIsDQogICJrSW5pbCI6ICJqZWxYIiwNCiAgImtJc2FrQW4iOiAiU2VsIiwNCiAgImtJc2lsIjogImxKdCIsDQogICJrSXh1dCI6ICJ4QXQsIHhJc0ZldGlrLCB4QXRpc3RpaywgZGVrcnl0aXYsIGJqVXRpZnlsLCBwcml0aSwga2pVdCIsDQogICJrSXh1dGF0IjogImRBbnMiLA0KICAia0l4dXRhdk94aXMiOiAidFUgc2lOIiwNCiAgImtpayI6ICJ4USwgdFUgbGlzeW4iLA0KICAia2ltT3QiOiAiZklsaU4sIHhpbVhTeW4sIHRVIGZJbCIsDQogICJraXNPayI6ICJwcmluc2lweWwsIHJVbCwgc3RySGtjeSwgc2lzdHltLCBsTyIsDQogICJraXNPa2F2T3hpcyI6ICJyaVZ5bSIsDQogICJ4b2wiOiAieEt0IiwNCiAgImtvbVVnIjogImdyS24sIHNRcmkveWx6IiwNCiAgImtvbiI6ICJ0ZW4iLA0KICAia09rSW4iOiAidFUgZnJJeiIsDQogICJrT2xhYiI6ICJ0VSBrWC9vcHlyS3QsIHRVIG1HYywgdFUga0FtYkpuLCB0VSBtaWtzIiwNCiAgImtvbSI6ICJzaWtzIiwNCiAgImtPbSI6ICJ0VSB2R25pUywgdFUgZGlzeXBRIiwNCiAgImtPbWV6IjogImhYbCwgaG9sWCwga0t2LCBwaXQsIGRpcHJlU3luIiwNCiAgImtPc090IjogInNYbCwgZ1hzdCIsDQogICJrb3MiOiAieGlsZXZ5biIsDQogICJrb3YiOiAibkpuIiwNCiAgImtvdkFzIjogImhvcnksIHRVIGZRIiwNCiAgInhveiI6ICJzZXZ5biIsDQogICJrVSI6ICIgW3BYbHkga3dlc2N5biBwcklmaWtzXSIsDQogICJrdWxPcyI6ICJmR2JyaWsiLA0KICAia3VsVW0iOiAiYlh0LCB2UWt5bCwgeGVsaXZLdHksIGt5bnZLL3kgYmVsdCwgdFUgdHJHbnNwb3J0IiwNCiAgImt1bEV6IjogImtyS3ppLCBzdHJLbnEsIHdRZCIsDQogICJrdXNBbCI6ICJyb3R5biIsDQogICJrdXQiOiAibVdWLCB0VSB4SXQsIHRVIGRyaU5rIiwNCiAgImt1dGFoVWdBbGFtIjogInRITiIsDQogICJrdXRha0luIjogInRVRiwgdFUgYkp0IiwNCiAgImt1dGFtIjogImZVZCIsDQogICJrdXRhbWFsb2thbSI6ICJrd2l6SW4sIGt1a2lOIiwNCiAgImt1dGFtYWxva2FtYWtBaFVrSW4iOiAic0l6eW5pTiIsDQogICJrVXhhZ2F0IjogImJIZywgeGluc2VrdCIsDQogICJrVXhpayI6ICJmQXN0IiwNCiAgImtVeGlrYXNVeiI6ICJzcElkIiwNCiAgImt1elVsIjogImJyWGt5biwgeEhuYkdseW5zdCwgW3N3UCB3WWR6XSIsDQogICJsIjogImxldCwgbUtrIiwNCiAgImxBeGVrIjogImxKaywgeHlwcklTaS9LdCwgeHlkbUoveSwgcHJLeiIsDQogICJsT2dBayI6ICJ0d2VsdiB0VSBWeSBwVy95IHhvdiBzaWtzIiwNCiAgImxVZ0FrIjogInR3ZWx2IHRVIFZ5IHBXL3kgeG92IHR3ZWx2IiwNCiAgImxFZ0FrIjogInR3ZWx2IHRVIFZ5IHBXL3kgeG92IHhLdEluIiwNCiAgImxJZ0FrIjogInR3ZWx2IHRVIFZ5IHBXL3kgeG92IHR3ZW50aSBmTyIsDQogICJsQWdBayI6ICJ0d2VsdiB0VSBWeSBwVy95IHhvdiBGWXRpIiwNCiAgImxBeGl0IjogInJKdGlOLCB4b3JGQWdySGZJLCBrR2xpZ3J5ZmksIHRVIHJKdCIsDQogICJsYWJheiI6ICJzV0YiLA0KICAibGFodWtVcyI6ICJib3R5bSBrbFhWeiwgcEFudHMsIHRyV3N5eiIsDQogICJsYWtJbiI6ICJ4WUYiLA0KICAibGFrSW5haGltRXoiOiAibUdwIiwNCiAgImxhbUF6IjogIlNHbFgiLA0KICAibGFuQXoiOiAiZElwIiwNCiAgImxhdCI6ICJ0VSBmT2wiLA0KICAibGF2T3oiOiAidFUgbEogZFduIiwNCiAgImxheiI6ICJib3R5bSwgZFduIiwNCiAgImxJZGF6IjogImtpTiwgbElkeSwgdFUgYkkgeGluIGNBcnEiLA0KICAibElkYXphZyI6ICJyTC95bCBwVy95IiwNCiAgImxJdnVzIjogInBLcHksIHBLcSIsDQogICJsb2thbSI6ICJ3WWssIHByb3Fla3QsIHRVIG1LaywgdFUga3JJL0t0LCB0VSB4aXN0R2JsaVMiLA0KICAibE8iOiAiW3hpbXBlcnl0aXYgbVVkLCB4aW1wbEpkIHhZZ3l0aXYga0tzIHRVIGJJIFtqVV1dIiwNCiAgImxPeGFkIjogInJYZCwgcEdGLCB3SywgcEdzaXEsIHRyR2ssIHhPYml0IiwNCiAgImxVIjogIlt4aW1wZXJ5dGl2IG1VZCwgeGltcGxKZCB4R2JzeWxVdGl2IGtLcyB0VSBiSSBbalVdXSIsDQogICJtIjogIkZPdCwgdFUgRmlOaywgdFUgbWVteXJpLCB0VSBtaXMiLA0KICAibUEiOiAiVmlzLCBWSXoiLA0KICAibUFsIjogIndJIFtmWXN0XSIsDQogICJtQW0iOiAibUhWWSIsDQogICJtQXoiOiAiblEsIHRVIHN0aWssIHRVIHBLc3QsIHRVIHh5dHJHa3QiLA0KICAibUF6YXNVeiI6ICJkaXN0eW5zIiwNCiAgIm1hZ0FsIjogInhYbGQiLA0KICAibWFnQWxhbSI6ICJ4WWxpL3lzdCwgeEd0IGZZc3QiLA0KICAibWFnQWxhbiI6ICJsS3R5c3QsIHhHdCBsQXN0IiwNCiAgIm1hZ0FsYXZPeGlzIjogInN0T3JpIiwNCiAgIm1haFVsIjogIm1IbkYiLA0KICAibWFrQXMiOiAialEiLA0KICAibWFrQXNhc1V6IjogInhLcSIsDQogICJtYWthayI6ICJ3SSBbZllzdCwgRllkXSIsDQogICJtYWtlaGlrQWwiOiAibkp0IiwNCiAgIm1ha2VuIjogInNJenluIiwNCiAgIm1hbW96IjogIndJayIsDQogICJtYWwiOiAieEoiLA0KICAibWFsQXYiOiAibEh2IiwNCiAgIm1hbUFuIjogImZqVWN5IiwNCiAgIm1hbWFuIjogIlZlbiwgeEFmdHkgVmVuIiwNCiAgIm1hbWV0IjogInhHdCBWaXMgbVhteW50IiwNCiAgIm1hbU96IjogImRLIiwNCiAgIm1hbmFsIjogIndJIFtmWXN0LCBzZWtIbmRdIiwNCiAgIm1hc0luIjogIm15U0luIiwNCiAgIm1hc2lsIjogIm5qVSIsDQogICJtYXRvbEl4b3MiOiAicGlySS9BZGlrLCB4aXR5cnl0aXYsIGxVcCwgZnJHa3R5bCwgc2VsZl9yZWZyeW5zIiwNCiAgIm1heiI6ICJoUSIsDQogICJtYXpJdiI6ICJiV25keXJpLCB4ZW5rV250eSwgeFh2eWxHcGlOLCB0VSBtSXQsIHRVIGtBbnRHa3QsIHRVIHhpbnR5c2VrdCIsDQogICJtZXpVbCI6ICJyUCwgbm90IHhvZkhuIiwNCiAgIm1JbHVrIjogImJyZXN0IiwNCiAgIm1payI6ICJTT3QiLA0KICAibWlsIjogInhKLCB0VSBzSSwgdFUgd29jIiwNCiAgIm1pbGFrT21leiI6ICJ3aW5kWCIsDQogICJtb2wiOiAic0htd29uIiwNCiAgIm1vbSI6ICJzSG1GaU4iLA0KICAibU96IjogImZKL3ksIGZsS20sIHRVIGJZbiIsDQogICJtT3pleiI6ICJyV25kLCBzWWt5bCwgc2ZRIiwNCiAgIm1PemV6YXQiOiAiclh0S3QiLA0KICAibU96ZXphdnVsQXQiOiAiZGlzayIsDQogICJtT3ppbCI6ICJyZWQiLA0KICAibU96b2dhbSI6ICJ4R1NpeiIsDQogICJtb3QiOiAiYnJLbiIsDQogICJtb3RlZGFtYXNJbiI6ICJreW1walV0eSIsDQogICJtb3oiOiAic0htd1AiLA0KICAibiI6ICJub2xpcSwgdFUgblgsIGJJIHhLYnlsIHRVIiwNCiAgIm5BIjogIlZHdCwgVlh6IiwNCiAgIm5BbCI6ICJqVSBbcGxPcnlsXSIsDQogICJuQW0iOiAibkttIiwNCiAgIm5BbWFtIjogImxLYnlsIiwNCiAgIm5BeiI6ICJmQSwgZGlzdHludCIsDQogICJuYWwiOiAialUgW3NpTmdqdWx5XSIsDQogICJuYXRlbklsIjogInN0SGRpLCB4ZXFVa0tTeW4sIHRVIHN0SGRpLCB0VSBsWW4sIHRVIGdldCBub2xpcSIsDQogICJuYXoiOiAiVlAiLA0KICAibkkiOiAiblh6LCB0VSBzbWVsIiwNCiAgIm5JeGFuIjogImtHdCIsDQogICJuT2hVbCI6ICJyaXZZIiwNCiAgIm5PayI6ICJsb04iLA0KICAibk9rYW0iOiAic3RpayIsDQogICJ4byI6ICJ4R25kIiwNCiAgInhPIjogIndpVi4uLltrb21pdEt0aXYgc0hmaWtzXSIsDQogICJ4b2JBYiI6ICJrb21pdCwgbUl0aS95IiwNCiAgInhvaFVsIjogIm1VbiIsDQogICJ4b21BbSI6ICJzdEEsIHh5c3RyeW5vbWlreWwgeEhicWVrdCIsDQogICJ4b21BbWFzSXN1dCI6ICJrb25zdGlsS1N5biwgZ0dseWtzaSIsDQogICJ4b21PeiI6ICJzSG4iLA0KICAieG9tT3phc0lzdXQiOiAic1hseSBzaXN0eW0iLA0KICAieGV6IjogIndvbiIsDQogICJzIjogInh5dGVtcHQsIHRVIHRySiIsDQogICJzQXhpbiI6ICJ3S3YsIGZsSGtjVS9LU3luLCBTS2ssIHZKYnJLU3luLCBwSGxzLCBibGlOaywgc0puIHdLdiIsDQogICJzQXhpdiI6ICJtSG5pLCB3ZWxGLCBiaWxvTmlOeiwgcHJlU3lzIG1ldHlsIiwNCiAgInNhZ0FzIjogInRVIHNZYywgdFUgZkpuZCwgdFUgaEhudCIsDQogICJzYWtBbiI6ICJmaVMiLA0KICAic2FrYWtJbiI6ICJmb3Jpc3QiLA0KICAic2FsSXZ1cyI6ICJidWsiLA0KICAic2F6IjogInhPbCIsDQogICJzSXhhbiI6ICJ3Si95LCBsSm4sIGJPZHksIGhQLCB0VSBsaU5rIiwNCiAgInNJeGFuYW0iOiAiclhwIiwNCiAgInNJeGFuYXRva0FnIjogInNuS2siLA0KICAic0lzdXQiOiAiZ3JVcCwga2xIc3R5LCBiSG5jLCB4eWtqVW1qdWxLU3luLCB0VSBnR1Z5LCB0VSBrQWxla3QiLA0KICAic2lrQXMiOiAid0trLCB4WHB5biwgc3RBdCIsDQogICJzaWtPbSI6ICJzbElwLCBrbFhzLCBzdG9wIiwNCiAgInNpa09tZXpBIjogImRySW0iLA0KICAic0lrdW4iOiAieHkgd1FkIGdKIiwNCiAgInNpbCI6ICJmalUiLA0KICAic2lsQXhpdCI6ICJrR3Jpa3R5LCBsZXR5LCBnbGlmIiwNCiAgInNpbGFtYW1hbU96IjogImplc3R5ZEsiLA0KICAic2lsYW4iOiAibmVrc3QiLA0KICAic2lsYW5hbWFtT3oiOiAidHltb3JYIiwNCiAgInNpbG9rYW0iOiAic2ltcHlsLCB4SXppIiwNCiAgInNpdk94aXMiOiAic2VudHlucywgc3RLdG15bnQiLA0KICAic29iQSI6ICJzb2x0IiwNCiAgInNvaFVsIjogIndldCIsDQogICJzb2tPbSI6ICJrWGxkIiwNCiAgInNva09tYW1ha2VuIjogIndpbnR5IiwNCiAgInNvbUF6IjogImdyR3ZpdGksIHh5dHJHa1N5biIsDQogICJzb21PeiI6ICJob3QsIGhJdCIsDQogICJzb21PemFtYWtlbiI6ICJzSG15IiwNCiAgInNvbkkiOiAic21lbCIsDQogICJzT3hpayI6ICJzbFgiLA0KICAic090IjogImhqVW15biwgbUduLCBwWXN5biIsDQogICJzT3RhYmF6IjogImtIbnRyaSwgc3RLdCwgdHJKYiwgdGVyaXR5cmkiLA0KICAic292T3hpcyI6ICJmWG5JbSIsDQogICJzb3phbkFtIjogIndZZCwgbU9mSW0iLA0KICAic3VtRWwiOiAiaFdzLCBoWG0sIHRVIGxKdiIsDQogICJzVXoiOiAibkhtYlksIHh5bVdudCwgZGlxaXQsIG1lWnlteW50LCB0VSBrV250LCB0VSBtZVp5LCB0VSBrd29udGlmSiIsDQogICJzdXZJdCI6ICJzd0l0LCBrR25kaSIsDQogICJ0IjogInRVIHdPaywgdFUgbVV2LCBiSSBnWC9pTiB0VSBkVSIsDQogICJ0YWtPbWV6IjogImRPIiwNCiAgInRhbk9zIjogImhHcGlueXMsIGZIbiwgdFUgcGxLIiwNCiAgInRhbk9zYXZPeGlzIjogInRVIGxBZiIsDQogICJ0ZWciOiAiZmlOZ3ksIHRVIHBMbnQiLA0KICAidGVnYW4iOiAiZmlOZ3l0aXAsIFZJIHhlbmQgeG92IHh5IGZpTmd5IiwNCiAgInRlZ0FsIjogInNIbSIsDQogICJ0ZWdha0luIjogImZpTmd5bktsIiwNCiAgInRlbklsIjogInRVIGdldCwgdFUgZ0tuLCB0VSByaXNJdiwgeHlkaVN5biBbbUdGXSIsDQogICJ0ZXQiOiAiaEduZCwgdFUgdEhjIiwNCiAgInRldGFtYXNJbiI6ICJtWGJIbCBmWG56LCBzbUF0IGZYbnosIHRIY2lOIG15U0lueiIsDQogICJ0ZXRhekEiOiAicEFtIiwNCiAgInRldGV6QSI6ICJ0VSBoWGxkIiwNCiAgInRpZ0F4dW4iOiAieEhWeSwgZGlmcnludCIsDQogICJ0aWtBbCI6ICJwVy95LCBzdHJvTiwgcFcveWZ5bCIsDQogICJ0b2tBZyI6ICJyZXB0Smx6IiwNCiAgInRvbkFsIjogInNKZCwgYmlzSmQsIG5RYkosIGJJIHdpViIsDQogICJ0T2hVa3V0IjogInRVIHNIayIsDQogICJ0T2hVbCI6ICJsS2siLA0KICAidE9rIjogImJpZywgdFUgc3dlbCIsDQogICJ0T2tha0luIjogInRySSIsDQogICJ0T2tJbiI6ICJtV250aW4iLA0KICAidE9taXNFbGEiOiAiVnkgcHJYdEdneW5pc3QiLA0KICAidE90ZXQiOiAidFUgaGl0IiwNCiAgInRPdGV0ZXpBIjogInRVIHNrd0l6IiwNCiAgInRvdCI6ICJmdXQsIGxlZyIsDQogICJ0b3Rha0FzZXoiOiAibkkiLA0KICAidG90YWt1bFVtIjogImJKc2lreWwiLA0KICAieHUiOiAic1giLA0KICAieFVtIjogInRVIFZHdCByaXpIbHQgYkogZFUvaU4sIFt0ckduc2xLdGl2IHNIZmlrc10iLA0KICAieFVuIjogImZPIFZHdCBySXp5biBWZW4sIFtrT3p5bCBzSGZpa3NdIiwNCiAgInZBIjogIltwQXRpa3lsIGZPIHh5dHJpYmp5dGl2IGtsT3pdIiwNCiAgInZBdGlrIjogInBBdGlreWwsIHhlbGltZW50eXJpIHBBdGlreWwsIG1Ka3JYIiwNCiAgInZha0VsIjogInRVIGJyS2ssIHRVIGtIdCwgdFUgc3BsaXQiLA0KICAidmF0QWwiOiAidFUgZ2l2LCB0VSBzcHJlZCwgdFUgcEFzLCB0VSBkaXNrQXJkLCBzSGJ0ckdrU3luW21HRl0iLA0KICAidkVrdXQiOiAiZEpyZWtTeW4sIHhHTmd5bCwgdmVrdHkiLA0KICAidmloVWwiOiAiZHJvcCIsDQogICJ2aWsiOiAic21PbCwgeHkgYml0LCB4eSBsaXR5bCwgdFUgU3JpTmsiLA0KICAidmlrYWtJbiI6ICJnckFzIiwNCiAgInZpa0VrSW4iOiAiZEhzdCIsDQogICJ2aWtJbiI6ICJzR25kIiwNCiAgInZpa3VzQWwiOiAieEdzaWQsIHNXL3kiLA0KICAidmlzb21PeiI6ICJ3T20iLA0KICAidmlzT3QiOiAiY0psZCwga2lkIiwNCiAgInZPIjogIltwQXRpa3lsIGZPIG5XbiBrbE96IHhvdiB4WWd5dGl2IGtLc10iLA0KICAidk94aXMiOiAic1duZCwgc3BJaywgdkxzLCB0T2ssIGxXZCwgdFUgc0ssIHRVIHNXbmQiLA0KICAia2V2T3hpcyI6ICJrd0oveXQsIHNKbHlucyIsDQogICJ2T3hpc2FkT3h1ZyI6ICJiZWx6LCB4eWxBbXosIHNwSWt5eiwgbUprcnlmWG4iLA0KICAidk94aXNhbU96ZXphdnVsQXQiOiAicmVrWWQsIGZvbnlnckdmIHJla1lkIiwNCiAgInZPc3V0IjogImJHZCIsDQogICJ2T3oiOiAidFUgcHV0LCB0VSBsWGtLdCwgdFUga0lwLCB0VSBwcnl0ZWt0IiwNCiAgInZVIjogIltwQXRpa3lsIGZPIG5XbiBrbE96IHhvdiB4R2JzeWxVdGl2IGtLc10iLA0KICAidnVsQXQiOiAiZmxPLCBwbEtuLCBmbEd0IiwNCiAgInZ1bEF0YWxPeGFkIjogInN0UCIsDQogICJ2VXhhbiI6ICJkb2ciLA0KICAiekFrQXMiOiAialVuaXZZcyIsDQogICJ6QW1hbSI6ICJ0Sm0iLA0KICAiemFoaWtBbGlsIjogIndKdCIsDQogICJ6YWhpa0FsaWxhc0F4aXYiOiAic2lsdnkiLA0KICAiemFtIjogInhZbGkveSwgcEFzdCwgYmloSm5kLCByUSwgYkdrIiwNCiAgInphbWFtYW1PeiI6ICJtT25pTiIsDQogICJ6YW1hc0l4YW5hbSI6ICJ0S2wiLA0KICAiemFtYXRldCI6ICJ0VSBwdWwiLA0KICAiemFuIjogImxLdHksIGZqVWN5LCB4eWhlZCwgZnJIbnQiLA0KICAiemFuQW0iOiAibEdOZ3dpcSIsDQogICJ6YW5hbWFtT3oiOiAieEdmdFluVW4iLA0KICAiemFuYXRldCI6ICJ0VSBwdVMiLA0KICAiemVkIjogInNpbWlseSwgbEprd0p6LCByaXBldGl0aXYsIHh5Z2VuLCB4b2xzWCwgdFUiLA0KICAiemV0YW1hbU96IjogIm5VbiIsDQogICJ6ZXRhdk96IjogInRVIHNpdCIsDQogICJ6SXhldE9rIjogIkZpayIsDQogICJ6SXhldmlrIjogIkZpbiIsDQogICJ6aXNJeGFrIjogIm1HZ25pdCwgbUdnbmV0aWsiDQp9'; 
const wordDB = JSON.parse(atob(encrypted));

// å­—ä½“åŠ è½½æ£€æµ‹
async function checkFontLoaded() {
    const font = new FontFace('Kiineza', 'url(fonts/Kiineza_Laaitu.woff2)');
    try {
        await font.load();
        document.fonts.add(font);
        await document.fonts.ready;
        if (!document.fonts.check('16px Kiineza')) throw new Error();
        document.body.classList.add('fonts-loaded');
        document.querySelector('.loading-overlay').style.display = 'none';
    } catch {
        showErrorState();
    }
}

function showErrorState() {
    const overlay = document.querySelector('.loading-overlay');
    overlay.querySelector('.loading-symbol').style.display = 'none';
    overlay.querySelector('.error-symbol').style.display = 'block';
    overlay.querySelector('.retry-symbol').style.display = 'block';
}

document.querySelector('.retry-symbol').addEventListener('click', () => location.reload());
setTimeout(() => !document.body.classList.contains('fonts-loaded') && showErrorState(), 8000);

// é”®ç›˜åˆå§‹åŒ–
const keyboardLayout = [
    ['v', 'b', 'm'],
    ['t', 'd', 'n'],
    ['s', 'z', 'l'],
    ['k', 'g', 'h'],
    ['o', 'u', 'e'],
    ['i', 'a', 'O'],
    ['U', 'E', 'I'],
    ['A', 'Ã—', 'â†µ']
];
function initKeyboard() {
    const keyboard = document.getElementById('keyboard');
    keyboardLayout.forEach(column => {
        const colDiv = document.createElement('div');
        colDiv.className = 'key-column';
        column.forEach(char => {
            const key = document.createElement('div');
            key.className = `key ${'AEIOUaeiou'.includes(char) ? 'vowel-key' : ''}`;
            key.dataset.char = char;
            key.addEventListener('click', () => handleKeyPress(char));
            colDiv.appendChild(key);
        });
        keyboard.appendChild(colDiv);
    });
}

// è¾“å…¥å¤„ç†é€»è¾‘
function processInput(str) {
    const consonants = new Set(['x','v','b','m','t','d','n','s','z','l','k','g','h']);
    let output = [];
    
    for(let i = 0; i < str.length; i++) {
        const current = str[i];
        if ('AEIOUaeiou'.includes(current)) {
            if(i === 0 || !consonants.has(str[i-1].toLowerCase())) {
                output.push('x');
            }
        }
        output.push(current);
    }
    return output.join('');
}

function handleKeyPress(char) {
    const display = document.getElementById('display');
    
    if(char === 'Ã—') {
      display.value = '';
      document.getElementById('result').innerHTML = '';
      // æ²¡æœ‰ .word-line-wrapper äº†ï¼ŒquerySelector ä¼šæ‹¿åˆ° nullï¼Œæ‰€ä»¥ä¸‹é¢è¦å…ˆåˆ¤ç©º
      const oldBtn = document.querySelector('.word-line-wrapper .read-button');
      if (oldBtn) oldBtn.style.display = 'none';
    } else if(char === 'â†µ') {
      const resultDiv = document.getElementById('result');
      if (!display.value) {
        resultDiv.innerHTML = `<div class="translation">naz/o kem/u xIn/ok/i.</div>`;
      } else if (!wordDB[display.value]) {
        resultDiv.innerHTML = `<div class="translation">mA sozanAm/u xekAs/i.</div>`;
      } else {
        // æˆåŠŸæŸ¥åˆ°ï¼šè¯ + æŒ‰é’® åŒè¡Œï¼Œç¿»è¯‘åœ¨ä¸‹
        resultDiv.innerHTML = `
          <div class="word-line-wrapper">
            <span class="word-line">${display.value}</span>
            <button class="read-button">ğŸ—£ï¸</button>
          </div>
          <div class="translation" style="color: var(--primary)">
            ${wordDB[display.value]}
          </div>
        `;
        bindReadButton(display.value);
      }
    } else {
        display.value += char;
        display.value = processInput(display.value);
    }
}

// â€”â€”â€” æœ—è¯»æ‰€éœ€çš„å…¨å±€å˜é‡ â€”â€”â€”

// ï¼ˆ1ï¼‰æ‹†èŠ‚æ˜ å°„è¡¨
const kanaMap = {
  // v ç³»åˆ—
  "vo": "ãƒ´ã‚©", "vu": "ãƒ´", "ve": "ãƒ´ã‚§", "vi": "ãƒ´ã‚£", "va": "ãƒ´ã‚¡", 
  "vO": "ãƒ´ã‚©ãƒ¼", "vU": "ãƒ´ãƒ¼", "vE": "ãƒ´ã‚§ãƒ¼", "vI": "ãƒ´ã‚£ãƒ¼", "vA": "ãƒ´ã‚¡ãƒ¼",
  
  // b ç³»åˆ—
  "bo": "ãƒœ", "bu": "ãƒ–", "be": "ãƒ™", "bi": "ãƒ“", "ba": "ãƒ", 
  "bO": "ãƒœãƒ¼", "bU": "ãƒ–ãƒ¼", "bE": "ãƒ™ãƒ¼", "bI": "ãƒ“ãƒ¼", "bA": "ãƒãƒ¼",
  
  // m ç³»åˆ—
  "mo": "ãƒ¢", "mu": "ãƒ ", "me": "ãƒ¡", "mi": "ãƒŸ", "ma": "ãƒ", 
  "mO": "ãƒ¢ãƒ¼", "mU": "ãƒ ãƒ¼", "mE": "ãƒ¡ãƒ¼", "mI": "ãƒŸãƒ¼", "mA": "ãƒãƒ¼",
  
  // t ç³»åˆ—
  "to": "ãƒˆ", "tu": "ãƒˆã‚¥", "te": "ãƒ†", "ti": "ãƒ†ã‚£", "ta": "ã‚¿", 
  "tO": "ãƒˆãƒ¼", "tU": "ãƒˆã‚¥ãƒ¼", "tE": "ãƒ†ãƒ¼", "tI": "ãƒ†ã‚£ãƒ¼", "tA": "ã‚¿ãƒ¼",
  
  // d ç³»åˆ—
  "do": "ãƒ‰", "du": "ãƒ‰ã‚¥", "de": "ãƒ‡", "di": "ãƒ‡ã‚£", "da": "ãƒ€", 
  "dO": "ãƒ‰ãƒ¼", "dU": "ãƒ‰ã‚¥ãƒ¼", "dE": "ãƒ‡ãƒ¼", "dI": "ãƒ‡ã‚£ãƒ¼", "dA": "ãƒ€ãƒ¼",
  
  // n ç³»åˆ—
  "no": "ãƒ", "nu": "ãƒŒ", "ne": "ãƒ", "ni": "ãƒ‹", "na": "ãƒŠ", 
  "nO": "ãƒãƒ¼", "nU": "ãƒŒãƒ¼", "nE": "ãƒãƒ¼", "nI": "ãƒ‹ãƒ¼", "nA": "ãƒŠãƒ¼",
  
  // s ç³»åˆ—
  "so": "ã‚½", "su": "ã‚¹", "se": "ã‚»", "si": "ã‚¹ã‚£", "sa": "ã‚µ", 
  "sO": "ã‚½ãƒ¼", "sU": "ã‚¹ãƒ¼", "sE": "ã‚»ãƒ¼", "sI": "ã‚¹ã‚£ãƒ¼", "sA": "ã‚µãƒ¼",
  
  // z ç³»åˆ—
  "zo": "ã‚¾", "zu": "ãƒ…", "ze": "ã‚¼", "zi": "ãƒ…ã‚£", "za": "ã‚¶", 
  "zO": "ã‚¾ãƒ¼", "zU": "ãƒ…ãƒ¼", "zE": "ã‚¼ãƒ¼", "zI": "ãƒ…ã‚£ãƒ¼", "zA": "ã‚¶ãƒ¼",
  
  // l ç³»åˆ—
  "lo": "ãƒ­", "lu": "ãƒ«", "le": "ãƒ¬", "li": "ãƒª", "la": "ãƒ©", 
  "lO": "ãƒ­ãƒ¼", "lU": "ãƒ«ãƒ¼", "lE": "ãƒ¬ãƒ¼", "lI": "ãƒªãƒ¼", "lA": "ãƒ©ãƒ¼",
  
  // k ç³»åˆ—
  "ko": "ã‚³", "ku": "ã‚¯", "ke": "ã‚±", "ki": "ã‚­", "ka": "ã‚«", 
  "kO": "ã‚³ãƒ¼", "kU": "ã‚¯ãƒ¼", "kE": "ã‚±ãƒ¼", "kI": "ã‚­ãƒ¼", "kA": "ã‚«ãƒ¼",
  
  // g ç³»åˆ—
  "go": "ã‚´", "gu": "ã‚°", "ge": "ã‚²", "gi": "ã‚®", "ga": "ã‚¬", 
  "gO": "ã‚´ãƒ¼", "gU": "ã‚°ãƒ¼", "gE": "ã‚²ãƒ¼", "gI": "ã‚®ãƒ¼", "gA": "ã‚¬ãƒ¼",
  
  // h ç³»åˆ—
  "ho": "ãƒ›", "hu": "ãƒ•", "he": "ãƒ˜", "hi": "ãƒ’", "ha": "ãƒ", 
  "hO": "ãƒ›ãƒ¼", "hU": "ãƒ•ãƒ¼", "hE": "ãƒ˜ãƒ¼", "hI": "ãƒ’ãƒ¼", "hA": "ãƒãƒ¼",
  
  // x ç³»åˆ—
  "xo": "ã‚ª", "xu": "ã‚¦", "xe": "ã‚¨", "xi": "ã‚¤", "xa": "ã‚¢", 
  "xO": "ã‚ªãƒ¼", "xU": "ã‚¦ãƒ¼", "xE": "ã‚¨ãƒ¼", "xI": "ã‚¤ãƒ¼", "xA": "ã‚¢ãƒ¼",
  
  // å•ä¸ªè¾…éŸ³
  "v": "ãƒ´", "b": "ãƒ–", "m": "ãƒ ", "t": "ãƒˆã‚¥", "d": "ãƒ‰ã‚¥", 
  "n": "ãƒŒ", "s": "ã‚¹", "z": "ãƒ…", "l": "ãƒ«", "k": "ã‚¯", 
  "g": "ã‚°", "h": "ãƒ•"
};

// ï¼ˆ2ï¼‰é¢„åŠ è½½è¯­éŸ³åˆ—è¡¨
let voices = [];
function loadVoices() {
  voices = speechSynthesis.getVoices();
}
if (speechSynthesis.onvoiceschanged !== undefined) {
  speechSynthesis.onvoiceschanged = loadVoices;
}
loadVoices();

// â€”â€”â€” å·¥å…·å‡½æ•° â€”â€”â€”

// æ‹†æˆä¸¤å­—æ¯ä¸€èŠ‚ï¼Œå°¾éƒ¨ä¸è¶³ä¸¤å­—æ¯å½“å•å­—èŠ‚èŠ‚
function splitSyllables(word) {
  const sylls = [];
  for (let i = 0; i < word.length; i += 2) {
    sylls.push(word.substring(i, i + 2));
  }
  return sylls;
}

// æ ¹æ® kanaMap æ‹¼å‡ºå‡åä¸²
function toKana(word) {
  return splitSyllables(word)
    .map(s => kanaMap[s] || "")  // å¦‚æœæ‰¾ä¸åˆ°å¯ä»¥ç•™ç©ºæˆ–åŠ ä¸€ä¸ªé»˜è®¤
    .join("");
}

// å‘å£°å‡½æ•°
function speakKana(kanaText) {
  if (!kanaText) return;
  const u = new SpeechSynthesisUtterance(kanaText);
  u.lang = 'ja-JP';
  // é€‰ä¸€ä¸ªæ—¥è¯­å¥³å£°ï¼ˆç¤ºä¾‹ï¼‰
  const v = voices.find(v => v.name.includes('Ayumi') || v.lang === 'ja-JP');
  if (v) u.voice = v;
  u.pitch = 1;
  u.rate = 1;
  u.volume = 5;
  speechSynthesis.speak(u);
}

// â€”â€”â€” ç»‘å®šæŒ‰é’®ä¸ç»“æœæ˜¾ç¤ºé€»è¾‘ â€”â€”â€”

const readBtn = document.getElementById('readBtn');
const resultDiv = document.getElementById('result');

function updateReadButton(word) {
  if (word && wordDB[word]) {
    readBtn.style.display = 'inline-block';
    readBtn.onclick = () => {
      const kana = toKana(word);
      speakKana(kana);
    };
  } else {
    readBtn.style.display = 'none';
    readBtn.onclick = null;
  }
}

function bindReadButton(word) {
  const btn = document.querySelector('.word-line-wrapper .read-button');
  // åˆšæ’å…¥å°±ç«‹å³éšè—ï¼Œç­‰ updateReadButton å†³å®šæ˜¯å¦æ˜¾ç¤º
  btn.style.display = 'none';

  if (word && wordDB[word]) {
    btn.style.display = 'inline-block';
    btn.onclick = () => {
      const kana = toKana(word);
      speakKana(kana);
    };
  }
}

document.querySelector('.help-button').addEventListener('click', function(e) {
    e.stopPropagation();
    const overlay = document.getElementById('helpOverlay');
    overlay.style.display = 'flex';
});

document.getElementById('helpOverlay').addEventListener('click', function() {
    this.style.display = 'none';
});

// åˆå§‹åŒ–
window.addEventListener('DOMContentLoaded', () => {
    initKeyboard();
    checkFontLoaded();
});
</script>
</body>
</html>
